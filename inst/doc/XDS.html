<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Read and analyse an XDS file</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Read and analyse an XDS file</h1>



<!-- Block with global markdown options

-->
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Main aim of this tutorial is to load the full content of two
different XDS files in the workspace, to analyse and modify data for one
of the two files, and to write the modified content into a new XDS
file.</p>
</div>
<div id="sample-xds-file" class="section level2">
<h2>Sample XDS file</h2>
<p>Some sample files are stored as external data in this package. Among
them there are two XDS files available with the current release. To
access the files, first load the <code>cry</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cry)</span></code></pre></div>
<p>Next, have a look at what is included in the external-data directory
of <code>cry</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>datadir <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="at">package=</span><span class="st">&quot;cry&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>all_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(datadir)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(all_files)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;1dei-sf.cif&quot;               &quot;1dei_phases.mtz&quot;          </span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3] &quot;2ol9_phases.mtz&quot;           &quot;3syu.cif&quot;                 </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;6vww_xds_ascii_merged.hkl&quot; &quot;AMS_DATA.cif&quot;             </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] &quot;e-65-00i60-Isup2.rtv&quot;      &quot;shelxc.log&quot;               </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;shelxd.log&quot;                &quot;shelxe_i.log&quot;             </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11] &quot;shelxe_o.log&quot;              &quot;xds00_ascii.hkl&quot;</span></span></code></pre></div>
<p>The two XDS files we are interested in are “xds00_ascii.hkl” and
“6vww_xds_ascii_merged.hkl”. Both files can be loaded using function
<code>readXDS_ASCII</code>.</p>
</div>
<div id="two-types-of-xds-files" class="section level2">
<h2>Two types of XDS files</h2>
<p>The <code>cry</code> function <code>readXDS_ASCII</code> can load in
the R working memory both XDS reflection files produced by XDS and
XSCALE. Their formats differ slightly. Let’s start by loading
“xds00_ascii.hkl”, which is created by the ’CORRECT’component of XDS.
The created object is a named list.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(datadir,<span class="st">&quot;xds00_ascii.hkl&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>objXDS1 <span class="ot">&lt;-</span> <span class="fu">readXDS_ASCII</span>(filename)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(objXDS1)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(objXDS1)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;processing_info&quot; &quot;header&quot;          &quot;reflections&quot;</span></span></code></pre></div>
<p>Each component of is either a named list, or a data frame. More
specifically:</p>
<ol style="list-style-type: decimal">
<li><p><code>processing_info</code></p>
<p>It’s a small named list with names <code>MERGE</code>,
<code>FRIEDEL</code> and <code>PROFILE_FITTING</code>. All these
components are logical variables (TRUE/FALSE). If <code>MERGE</code> is
TRUE, the file has been produced by XSCALE. If <code>FRIEDEL</code> is
TRUE, the Bijvoet pairs have been averaged to respect Friedel’s law.
<code>PROFILE_FITTING</code> is only TRUE for files produced by
XDS.</p></li>
<li><p><code>header</code></p>
<p>This is a longer named list with components related to the
diffraction experiment including for example the oscillation range, the
fraction of polarization, the rough cell parameters’ estimate,
etc.</p></li>
<li><p><code>reflections</code></p>
<p>These are the experimental observations, i.e. the integrated
intensity, its error, and other qualities for each triplet of Miller
indices. They are included in a data frame.</p></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &#39;reflections&#39; is a data frame</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">class</span>(objXDS1<span class="sc">$</span>reflections))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;data.frame&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># First 5 observations</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(objXDS1<span class="sc">$</span>reflections[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   H K   L   IOBS SIGMA.IOBS.     XD    YD   ZD     RLP PEAK CORR   PSI</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0 0 -35  61.77       128.4 2094.2 664.4  6.4 0.17998   92    7 62.60</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0 0 -36 137.70       136.3 2120.2 645.5 10.3 0.18539   99    8 62.91</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0 0 -38 -29.38       153.9 2172.7 607.6 18.0 0.19628  100   -7 63.53</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0 0 -39 -23.68       158.5 2199.2 588.5 21.9 0.20176  100   -7 63.85</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0 0 -40  73.30       161.0 2226.0 569.5 25.8 0.20726  100    8 64.16</span></span></code></pre></div>
<p>A file produced by XSCALE has in general a smaller number of data
columns:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the other XDS ascii file</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="fu">file.path</span>(datadir,<span class="st">&quot;6vww_xds_ascii_merged.hkl&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>objXDS2 <span class="ot">&lt;-</span> <span class="fu">readXDS_ASCII</span>(filename,<span class="at">message=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  File read successfully.</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  There are 27951 reflections in this file.</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Here is a summary of the observations:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -1.085   2.089   2.920   2.868   3.684   5.888</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># This file has been produced by XSCALE</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(objXDS2<span class="sc">$</span>processing_info<span class="sc">$</span>MERGE)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># First 5 observations</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(objXDS2<span class="sc">$</span>reflections[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   H K  L     IOBS SIGMA.IOBS.</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0 0  4   192900       78780</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0 0  6  1707000      694600</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0 0  8 16670000     6782000</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4 0 0 10   224900       93500</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5 0 0 12  7838000     3189000</span></span></code></pre></div>
</div>
<div id="the-xds-reflections" class="section level2">
<h2>The XDS reflections</h2>
<p>Let us focus on the dataset produced by XSCALE. The full set of data
is contained, as seen, in a data frame structure. This makes it easy to
carry out the usual selection, reshaping and statistical operations
normally available in R.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy reflections data for the first and</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># second dataset, to save on later typing</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>refs1 <span class="ot">&lt;-</span> objXDS1<span class="sc">$</span>reflections</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>refs2 <span class="ot">&lt;-</span> objXDS2<span class="sc">$</span>reflections</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Check whether the set of reflections is unique</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset 1</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>nrefs1 <span class="ot">&lt;-</span> <span class="fu">length</span>(refs1[,<span class="dv">1</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nrefs1)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3315</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>n_unique1 <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(refs1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])[,<span class="dv">1</span>])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n_unique1)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3315</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset 2</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>nrefs2 <span class="ot">&lt;-</span> <span class="fu">length</span>(refs2[,<span class="dv">1</span>])</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nrefs2)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 27951</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>n_unique2 <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(refs2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])[,<span class="dv">1</span>])</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(n_unique2)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 27951</span></span></code></pre></div>
<p>Both datasets have only one value per reflection. But the space group
associated with the first dataset is P1, while the space group
associated with the second dataset is P -3 1 c, belonging to the
trigonal crystal system.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Space group of first dataset</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(objXDS1<span class="sc">$</span>header<span class="sc">$</span>SPACE_GROUP_NUMBER)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Space group of second dataset</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(objXDS2<span class="sc">$</span>header<span class="sc">$</span>SPACE_GROUP_NUMBER)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 163</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extended Hermann-Mauguin symbol for symmetry n 163</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>SG <span class="ot">&lt;-</span> <span class="fu">translate_SG</span>(<span class="dv">163</span>)<span class="sc">$</span>msg</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(SG)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;P -3 1 c&quot;</span></span></code></pre></div>
<p>This means that while the reflections of the second file are actually
the result of averaging among multiple values of equivalent reflections
(both because of multiplicity and symmetry), those of the first file
derive from averaging due to multiplicity; once the symmetry for the
crystal structure has been established, some of the reflections will be
related by symmetry and a new unique set can be calculated after the
appropriate merging.</p>
<p>Data selection can be carried out using conditions on the
intensities, for example. Let us consider the second dataset and single
out those reflections with <span class="math inline">\(\mathrm{I/sigI}
&gt; 2\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Names of data columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(refs2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;H&quot;           &quot;K&quot;           &quot;L&quot;           &quot;IOBS&quot;        &quot;SIGMA.IOBS.&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selection based on I/sigI &gt; 2</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS <span class="sc">&gt;</span> <span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">length</span>(idx))  <span class="co">#  21579 reflections have I/sigI &gt; 2</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 21579</span></span></code></pre></div>
<p>Visually, the separation between reflections with <span class="math inline">\(\mathrm{I/sigI} \leq 2\)</span> and those with
<span class="math inline">\(\mathrm{I/sigI} &gt; 2\)</span> can be
demonstrated with a frequency histogram.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new I/sigI array</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>isi <span class="ot">&lt;-</span> refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>hh <span class="ot">&lt;-</span> <span class="fu">hist</span>(isi,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> <span class="fu">cut</span>(hh<span class="sc">$</span>breaks,<span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">2</span>,<span class="cn">Inf</span>))</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hh,<span class="at">main=</span><span class="st">&quot;I/sigI&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;I/sigI&quot;</span>,<span class="at">col=</span>cuts)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Data selection can also follow a different ordering of the data.
Consider again, in dataset 2, the first 10 reflections:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First reflections in original data ordering</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(refs2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    H K  L     IOBS SIGMA.IOBS.</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  0 0  4   192900       78780</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0 0  6  1707000      694600</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  0 0  8 16670000     6782000</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  0 0 10   224900       93500</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  0 0 12  7838000     3189000</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  0 0 14  3230000     1859000</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7  0 0 16   118200       51690</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8  0 0 18  2158000      878600</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9  0 0 20    16970       35280</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 0 0 22   433600      181900</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span></code></pre></div>
<p>We could, next, sort the data from the largest to the smallest value
of the intensity:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First create the ordering index</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">order</span>(refs2<span class="sc">$</span>IOBS,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now display the first 10 reflections. They correspond to the</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 reflections with highest intensity</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(refs2[idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       H  K  L     IOBS SIGMA.IOBS.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 13    0  0 28 18660000     7591000</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     0  0  8 16670000     6782000</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1081  6 -2 -8 12950000     3746000</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3753 11 -3  0 12730000     3999000</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3996 11 -1 -3  9507000     2552000</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 120   2 -1 -2  9322000     3794000</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9415 17  0 15  9287000     3168000</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1396  7 -3 -6  9004000     3665000</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3070 10 -3 -6  8756000     1967000</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1807  8 -4 -4  8733000     2939000</span></span></code></pre></div>
<p>Or, we could sort the data according to the decreasing values of
<span class="math inline">\(\mathrm{I/sigI}\)</span>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordering index</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">order</span>(refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first 10 highest I/sigI reflections</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(refs2[idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       H  K   L    IOBS SIGMA.IOBS.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2481  9 -3  20 2202000      374000</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 166   2  0  17 2441000      415400</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1200  6 -1 -14 2438000      416500</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 684   5 -2 -29 1052000      180700</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2058  8 -2  31 1176000      202800</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3345 10 -1  23 1599000      276000</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1304  6  0  27 1944000      335900</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1387  7 -3 -15 2502000      432500</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1301  6  0  24 1534000      266000</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1305  6  0  28 1262000      219000</span></span></code></pre></div>
<p>To verify that the operation is correct, we can add a new column to
the original <code>refs2</code> data frame and verify that the previous
ordering corresponds, indeed, to decreasing values of <span class="math inline">\(\mathrm{I/sigI}\)</span>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add an I/sigI column</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>refs2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(refs2,<span class="fu">data.frame</span>(<span class="at">IsigI=</span>refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now display with the order previously obtained</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(refs2[idx[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>],])</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       H  K   L    IOBS SIGMA.IOBS.    IsigI</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2481  9 -3  20 2202000      374000 5.887701</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 166   2  0  17 2441000      415400 5.876264</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1200  6 -1 -14 2438000      416500 5.853541</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 684   5 -2 -29 1052000      180700 5.821804</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2058  8 -2  31 1176000      202800 5.798817</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3345 10 -1  23 1599000      276000 5.793478</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1304  6  0  27 1944000      335900 5.787437</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1387  7 -3 -15 2502000      432500 5.784971</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1301  6  0  24 1534000      266000 5.766917</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1305  6  0  28 1262000      219000 5.762557</span></span></code></pre></div>
<p>We can also carry out routine statistics of the values of the data
frame. It is very quick, for instance, to obtain summary statistics for
all the columns:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(refs2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        H               K                 L                IOBS         </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   : 0.00   Min.   :-15.000   Min.   :-62.000   Min.   : -537600  </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:15.00   1st Qu.: -8.000   1st Qu.:-28.000   1st Qu.:  202750  </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median :21.00   Median : -4.000   Median :  4.000   Median :  417600  </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   :20.15   Mean   : -5.041   Mean   :  1.997   Mean   :  635462  </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:26.00   3rd Qu.: -2.000   3rd Qu.: 32.000   3rd Qu.:  810750  </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :30.00   Max.   :  0.000   Max.   : 62.000   Max.   :18660000  </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   SIGMA.IOBS.          IsigI       </span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Min.   :   2992   Min.   :-1.085  </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:  91430   1st Qu.: 2.089  </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Median : 144600   Median : 2.920  </span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Mean   : 196604   Mean   : 2.868  </span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 238500   3rd Qu.: 3.684  </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Max.   :7591000   Max.   : 5.888</span></span></code></pre></div>
</div>
<div id="specific-types-of-data-visualisation" class="section level2">
<h2>Specific types of data visualisation</h2>
<p>The advantage of having crystallographic data imported in R is that
they can be exposed to several types of data visualisation and
statistical analysis available in the platform. In this section an
histogram visualisation has been created for the original dataset, in
which that part of the histogram corresponding to <span class="math inline">\(\mathrm{I/sigI} &gt; 2\)</span> is coloured
differently. This is not an operation easily achievable with standard
crystallographic software, but relatively easy to carry out using R.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial histogram</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mtxt <span class="ot">&lt;-</span> <span class="st">&quot;I/sigI and top quartile for I&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>hh <span class="ot">&lt;-</span> <span class="fu">hist</span>(refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">main=</span>mtxt,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;I/sigI&quot;</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Find top quartile of I</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>top_qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(refs2<span class="sc">$</span>IOBS)[<span class="dv">4</span>]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with absolute intensity in the top quartile</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(refs2<span class="sc">$</span>IOBS <span class="sc">&gt;=</span> top_qt)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Colour portion of histogram in red</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(refs2<span class="sc">$</span>IOBS[idx]<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS[idx],<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Another useful but not easily available visualisation is with
histograms where lowest or highest resolutions are highlighted in a
different colour. A resolution vector with the same ordering of the
original data frame must first be calculated with the <code>cry</code>
function <code>hkl_to_reso</code> and this can be then used to select
data with wanted resolution.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell parameters are needed to calculate resolutions</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cpars <span class="ot">&lt;-</span> objXDS2<span class="sc">$</span>header<span class="sc">$</span>UNIT_CELL_CONSTANTS</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Resolutions in angstroms. (resos has been computed previously)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>resos <span class="ot">&lt;-</span> <span class="fu">hkl_to_reso</span>(refs2<span class="sc">$</span>H,refs2<span class="sc">$</span>K,refs2<span class="sc">$</span>L,cpars[<span class="dv">1</span>],cpars[<span class="dv">2</span>],cpars[<span class="dv">3</span>],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                     cpars[<span class="dv">4</span>],cpars[<span class="dv">5</span>],cpars[<span class="dv">6</span>])</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resos)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1.785   2.314   3.226   3.957   4.776  49.263</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Select high resolution data ( &lt;= 2 angstroms)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(resos <span class="sc">&lt;=</span> <span class="dv">2</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Now draw the histogram</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>mtxt <span class="ot">&lt;-</span> <span class="st">&quot;I/sigI and top quartile for I&quot;</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>hh <span class="ot">&lt;-</span> <span class="fu">hist</span>(refs2<span class="sc">$</span>IOBS<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">main=</span>mtxt,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab=</span><span class="st">&quot;I/sigI&quot;</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(refs2<span class="sc">$</span>IOBS[idx]<span class="sc">/</span>refs2<span class="sc">$</span>SIGMA.IOBS[idx],<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="dv">2</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The above histogram reflects the unfortunate circumstance in
structural x-ray crystallography, according to which high resolution
data correspond on average to weak intensities.</p>
</div>
<div id="write-data-to-an-xds-file" class="section level2">
<h2>Write data to an XDS file</h2>
<p>The necessity to modify existing XDS ascii files or to simulate new
ones (by developers to test software, for example) can be satisfied with
the use of the <code>writeXDS_ASCII</code> function. The nature and
quality of the file produced will depend on the feasibility and accuracy
of the information provided. For this reason, it is more difficult to
write an XDS ascii file for unmerged data because a lot of information
of an experimental nature has to be provided so to produce a sensible
header.</p>
<p>In this section the original data from the
“6vww_xds_ascii_merged.hkl” file will be truncated to 2 angstroms and
written to a new XDS ascii file with a different date.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Date</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ddd <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">Sys.Date</span>())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>stmp <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(ddd,<span class="st">&quot;-&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>allMonths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Jan&quot;</span>,<span class="st">&quot;Feb&quot;</span>,<span class="st">&quot;Mar&quot;</span>,<span class="st">&quot;Apr&quot;</span>,<span class="st">&quot;May&quot;</span>,<span class="st">&quot;Jun&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Jul&quot;</span>,<span class="st">&quot;Aug&quot;</span>,<span class="st">&quot;Sep&quot;</span>,<span class="st">&quot;Oct&quot;</span>,<span class="st">&quot;Nov&quot;</span>,<span class="st">&quot;Dec&quot;</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>objXDS2<span class="sc">$</span>header<span class="sc">$</span>DATE <span class="ot">&lt;-</span> <span class="fu">paste0</span>(stmp[<span class="dv">3</span>],<span class="st">&quot;-&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>            allMonths[<span class="fu">as.integer</span>(stmp[<span class="dv">2</span>])],<span class="st">&quot;-&quot;</span>,stmp[<span class="dv">1</span>])</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generated by</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>objXDS2<span class="sc">$</span>header<span class="sc">$</span>GENERATED_BY <span class="ot">&lt;-</span> <span class="st">&quot;CRY&quot;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Data to 2 angstroms resolution</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(resos <span class="sc">&gt;=</span> <span class="dv">2</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>objXDS2<span class="sc">$</span>reflections <span class="ot">&lt;-</span> objXDS2<span class="sc">$</span>reflections[idx,]</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Temporary directory for output</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>tdir <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">file.path</span>(tdir,<span class="st">&quot;new.hkl&quot;</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Write changed data to the new XDS ascii file</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="fu">writeXDS_ASCII</span>(objXDS2<span class="sc">$</span>processing_info,objXDS2<span class="sc">$</span>header,</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>               objXDS2<span class="sc">$</span>reflections,fname)</span></code></pre></div>
<p>Data from the new XDS ascii file can either be explored using XDS
software, or read back into R using again
<code>readXDS_ASCII</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data from &quot;new.hkl&quot;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>newXDS <span class="ot">&lt;-</span> <span class="fu">readXDS_ASCII</span>(fname,<span class="at">message=</span><span class="cn">TRUE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  File read successfully.</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  There are 24689 reflections in this file.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Here is a summary of the observations:</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  -1.085   2.383   3.091   3.062   3.782   5.888</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
